<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APES: birth weight data example • APES</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="APES: birth weight data example">
<meta property="og:description" content="APES">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">APES</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/APES.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/birthweight.html">APES: birth weight data example</a>
    </li>
    <li>
      <a href="../articles/diabetes.html">APES: diabetes data example</a>
    </li>
    <li>
      <a href="../articles/install_bestsubset.html">Install `bestsubset`</a>
    </li>
    <li>
      <a href="../articles/speed.html">Speeding up APES</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kevinwang09/APES/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="birthweight_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="birthweight_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="birthweight_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>APES: birth weight data example</h1>
                        <h4 class="author">Kevin Y.X. Wang</h4>
            <address class="author_afil">
      School of Mathematics and Statistics, The University of Sydney, Australia<br><h4 class="author">Garth Tarr</h4>
            <address class="author_afil">
      School of Mathematics and Statistics, The University of Sydney, Australia<br><h4 class="author">Jean Y.H. Yang</h4>
            <address class="author_afil">
      School of Mathematics and Statistics, The University of Sydney, Australia<br><h4 class="author">Samuel Mueller</h4>
            <address class="author_afil">
      Department of Mathematics and Statistics, Macquarie University, Australia<br><small class="dont-index">Source: <a href="https://github.com/kevinwang09/APES/blob/master/vignettes/birthweight.Rmd"><code>vignettes/birthweight.Rmd</code></a></small>
      <div class="hidden name"><code>birthweight.Rmd</code></div>

    </address>
</address>
</address>
</address>
</div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this vignette, we will demonstrate a real application of APES on a logistic regression model. The data we have chosen is the birth weight (<code>birthwt</code>) data from the <code>MASS</code> package. In this data, there are 189 observations and the binary response variable is whether an infant is in the low-weight group (<code>low</code>). There are eight predictor variables in total comprising of two numeric variables (<code>age</code> and <code>lwt</code>) and six others are factor variables.</p>
</div>
<div id="loading-packages-and-setting-up-the-data" class="section level1">
<h1 class="hasAnchor">
<a href="#loading-packages-and-setting-up-the-data" class="anchor"></a>Loading packages and setting up the data</h1>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kevinwang09/APES">APES</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.2     ✔ purrr   0.3.4
## ✔ tibble  3.0.4     ✔ dplyr   1.0.2
## ✔ tidyr   1.1.2     ✔ stringr 1.4.0
## ✔ readr   1.4.0     ✔ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ✖ dplyr::select() masks MASS::select()</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"birthwt"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span>

<span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_classic</span><span class="op">(</span><span class="fl">14</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>We will simplify the data using the code below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">bwt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">birthwt</span>, <span class="op">{</span>
  <span class="va">race</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">race</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"black"</span>, <span class="st">"other"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">ptd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ptl</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
  <span class="va">ftv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ftv</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">ftv</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"2+"</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">low</span><span class="op">)</span>, <span class="co">## indicator for low-weight group</span>
             <span class="va">age</span>, <span class="co">## mother's age in years</span>
             <span class="va">lwt</span>, <span class="co">## mother's weight in pounds at last menstrual period</span>
             <span class="va">race</span>, <span class="co">## mother's race (white, black, other)</span>
             smoke <span class="op">=</span> <span class="op">(</span><span class="va">smoke</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## smoking status during pregnancy</span>
             <span class="va">ptd</span>, <span class="co">## indicator for previous premature labours</span>
             ht <span class="op">=</span> <span class="op">(</span><span class="va">ht</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## indicator for history of hypertension</span>
             ui <span class="op">=</span> <span class="op">(</span><span class="va">ui</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## indicator for uterine irritability</span>
             <span class="va">ftv</span> <span class="co">## number of physician visits during the first trimester</span>
             <span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="fu">glimpse</span><span class="op">(</span><span class="va">bwt</span><span class="op">)</span></pre></div>
<pre><code>## Rows: 189
## Columns: 9
## $ low   &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ age   &lt;int&gt; 19, 33, 20, 21, 18, 21, 22, 17, 29, 26, 19, 19, 22, 30, 18, 18,…
## $ lwt   &lt;int&gt; 182, 155, 105, 108, 107, 124, 118, 103, 123, 113, 95, 150, 95, …
## $ race  &lt;fct&gt; black, other, white, white, white, other, white, other, white, …
## $ smoke &lt;lgl&gt; FALSE, FALSE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE…
## $ ptd   &lt;fct&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
## $ ht    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
## $ ui    &lt;lgl&gt; TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, FAL…
## $ ftv   &lt;fct&gt; 0, 2+, 1, 2+, 0, 0, 1, 1, 1, 0, 0, 1, 0, 2+, 0, 0, 0, 2+, 0, 1,…</code></pre>
</div>
<div id="single-run-of-apes-on-birthweight-data" class="section level1">
<h1 class="hasAnchor">
<a href="#single-run-of-apes-on-birthweight-data" class="anchor"></a>Single run of APES on birthweight data</h1>
<p>We will first fit a “full” logistic regression model utilising all available variables to get a preliminary understanding of the data and the model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">full_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">low</span> <span class="op">~</span> <span class="va">.</span>, family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">bwt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span>, <span class="fl">3</span><span class="op">)</span></pre></div>
<pre><code>##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)    0.823      1.245   0.661    0.508
## age           -0.037      0.039  -0.962    0.336
## lwt           -0.016      0.007  -2.211    0.027
## raceblack      1.192      0.536   2.225    0.026
## raceother      0.741      0.462   1.604    0.109
## smokeTRUE      0.756      0.425   1.778    0.075
## ptdTRUE        1.344      0.481   2.796    0.005
## htTRUE         1.913      0.721   2.654    0.008
## uiTRUE         0.680      0.464   1.465    0.143
## ftv1          -0.436      0.479  -0.910    0.363
## ftv2+          0.179      0.456   0.392    0.695</code></pre>
<p>While on the outset, many of these variables would have seem to have an impact on the birth weight of an infant, the summary of the logistic model (in particular the p-values) imply that some variables are redundant. So we may wish to perform variable selection on this data using the <code>APES</code> package with the main function being <code>apes</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">apes_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/apes.html">apes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">full_model</span><span class="op">)</span>
<span class="va">apes_result</span></pre></div>
<pre><code>## Time taken:  0.0002449671  minutes 
## 
##  APES - AIC selected the following variables 
## intercept       age       lwt raceblack raceother smokeTRUE   ptdTRUE    htTRUE 
##     0.095     0.000    -0.017     1.264     0.864     0.876     1.231     1.767 
##    uiTRUE      ftv1     ftv2+ 
##     0.000     0.000     0.000 
## 
##  APES - BIC selected the following variables 
## intercept       age       lwt raceblack raceother smokeTRUE   ptdTRUE    htTRUE 
##    -1.057     0.000     0.000     0.000     0.000     0.000     1.463     0.000 
##    uiTRUE      ftv1     ftv2+ 
##     0.000     0.000     0.000</code></pre>
<p>The <code>apes_result</code> gives us an indiaction as to which variables are considered to be the most important by the Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC) under an approximated exhaustive search. Note that APES handles a factor variable in similar style as other <code>R</code> packages by (alphabetically) selecting a level in the factor as the reference level and compare all other levels against this reference.</p>
</div>
<div id="variable-selection-stability" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-selection-stability" class="anchor"></a>Variable selection stability</h1>
<p>Suppose we are using the BIC as the main selection criterion, a single application of APES suggests that we should only select the <code>ptd</code> variable. However, <a href="http://garthtarr.github.io/mplot/articles/birthweight.html">previous studies into this data</a> suggested that this data possess several interesting characteristics, one being variable selection instability. This means that the variables we select based on a single application of any model selection method cannot always be reproduced if the data is slightly perturbed. One way we can confirm the existence of this instability is to perform a bootstrap resampling of the observations, this introduces a perturbation on the data which affects model selection.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">boot_bwt</span> <span class="op">=</span> <span class="va">bwt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bwt</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bwt</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">full_model2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">low</span> <span class="op">~</span> <span class="va">.</span>, family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">boot_bwt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">full_model2</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span>, <span class="fl">3</span><span class="op">)</span></pre></div>
<pre><code>##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)    0.382      1.194   0.320    0.749
## age           -0.001      0.039  -0.038    0.970
## lwt           -0.017      0.007  -2.518    0.012
## raceblack      1.238      0.515   2.404    0.016
## raceother      0.346      0.487   0.711    0.477
## smokeTRUE      0.824      0.433   1.901    0.057
## ptdTRUE        1.097      0.486   2.257    0.024
## htTRUE         1.602      0.832   1.926    0.054
## uiTRUE         0.819      0.483   1.695    0.090
## ftv1          -0.970      0.553  -1.754    0.079
## ftv2+         -0.194      0.458  -0.423    0.672</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="../reference/apes.html">apes</a></span><span class="op">(</span><span class="va">full_model2</span><span class="op">)</span></pre></div>
<pre><code>## Time taken:  7.998943e-06  minutes 
## 
##  APES - AIC selected the following variables 
## intercept       age       lwt raceblack raceother smokeTRUE   ptdTRUE    htTRUE 
##     0.614     0.000    -0.018     1.111     0.000     0.681     1.161     1.675 
##    uiTRUE      ftv1     ftv2+ 
##     0.812    -0.996     0.000 
## 
##  APES - BIC selected the following variables 
## intercept       age       lwt raceblack raceother smokeTRUE   ptdTRUE    htTRUE 
##     0.897     0.000    -0.016     1.054     0.000     0.000     1.423     0.000 
##    uiTRUE      ftv1     ftv2+ 
##     0.000    -1.315     0.000</code></pre>
<p>We can see that when we perturb on the data, the p-value for the <code>ht</code> variable increases from 0.008 to 0.054, which could cause confusion if we take a naive approach to only select variables with p-values &lt; 0.05. Similarly, this perturbation also affects APES, as we have now selected three extra variables under the BIC. Variable selection stability is not a criticism of any specific methods, but rather, it is an issue for data with ambiguous signals. We will describe how the <code>APES</code> package uses bootstrap resampling to improve variable selection stability in the next section.</p>
</div>
<div id="bootstrapping-with-the-apes-package" class="section level1">
<h1 class="hasAnchor">
<a href="#bootstrapping-with-the-apes-package" class="anchor"></a>Bootstrapping with the <code>APES</code> package</h1>
<p>One way that we can improve variable selection stability is to apply <code>APES</code> on many bootstrap resampling of the data and then average the computed results. As the main motivation of APES is to make exhaustive selection fast and it is therefore also ideally suited for such a procedure which requires a large amount of computation.</p>
<p>Running the <code>apes</code> function with an extra argument <code>n_boot</code> automatically invokes bootstrapping sampling on the rows of the data. The returned object is a <code>boot_apes</code> class object which stores all bootstrapped <code>apes</code> objects. This class comes with generic <code>print</code>, <code>summary</code> and <code>plot</code> methods, which make the interaction with such an object much easier.</p>
<p>The <code>summary</code> method summarises the averaged selection (empirical) probability of each variable for a given information criterion. In the next section, we will explore the <code>plot</code> generic methods for this object class.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">boot_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/apes.html">apes</a></span><span class="op">(</span><span class="va">full_model</span>, n_boot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot_result</span>, ic <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot_result</span>, ic <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></pre></div>
</div>
<div id="variable-importance-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-importance-plot" class="anchor"></a>Variable importance plot</h1>
<p>The variable importance plot is a technique explored in Murray et. al. (2013) and it shows the stability of each variable as empirical probability of selection against different penalty terms, assuming the a general information criterion formulation $-2 + (p + 1) $, where <span class="math inline">\(\ell\)</span> is the log-likelihood of a model, <code>\lambda</code> is the penalty term and <span class="math inline">\(p\)</span> is the number of predictors (excluding the intercept term). The most important difference between this <code>plot</code> method and the <code>summary</code>/<code>method</code> methods is that we are no longer fixated on a single information criterion such as the AIC (where <span class="math inline">\(\lambda = 2\)</span>) and the BIC (where <span class="math inline">\(\lambda = \log(p)\)</span>). Instead, we can visualise the selection with ever increasing penalty term <span class="math inline">\(\lambda\)</span>. Variables with stronger selection stability are those with high probabilities of selection with increasingly higher levels of penalisation.</p>
<p>We can see that the variables in order of strength of stability are <code>ptd</code>, <code>ht</code> and <code>lwt</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">boot_result</span>, type <span class="op">=</span> <span class="st">"vip"</span><span class="op">)</span></pre></div>
<p><img src="birthweight_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div id="tile-version-of-vip-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#tile-version-of-vip-plot" class="anchor"></a>Tile version of VIP plot</h2>
<p>This plot is identical in construction as the VIP plot above. However, the probability of selection is used as colours in a tile plot. The most stably selected variables are on the top of the y-axis.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">boot_result</span>, type <span class="op">=</span> <span class="st">"vip_tile"</span><span class="op">)</span></pre></div>
<p><img src="birthweight_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="model-averaged-coefficient-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#model-averaged-coefficient-plot" class="anchor"></a>Model averaged coefficient plot</h2>
<p>APES stores all the coefficient estimates in each bootstrap run. We can use this information to compute cumulative averages of variable coefficients. This plot allows us to examine the stability of the model coefficient estimates whereas the previous VIP plots shows only the stability of variable selection.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">boot_result</span>, type <span class="op">=</span> <span class="st">"ma"</span><span class="op">)</span></pre></div>
<p><img src="birthweight_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="information-criterion-pathway-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#information-criterion-pathway-plot" class="anchor"></a>Information criterion pathway plot</h2>
<p>During the bootstrap computations, APES records the best AIC/BIC models across all bootstrap runs. Due to the induced perturbation, the AIC/BIC-best model in each bootstrapped data do not always coincide. One way to examine the differences between these models is to look into the model size of the best selected model.</p>
<p>Here, each bootstrap run is represented by a black curve with the BIC-selected model of each run coloured as red. We can see that it is rare for a model of size 2 to be selected when using the BIC, with the majority of the models being between 3 and 6 in model size. This is a reason why we should perform such a bootstrap procedure to examine the model selection stability as a single run of APES only identifies a model of size two under the BIC selection criterion.</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">boot_result</span>, type <span class="op">=</span> <span class="st">"path"</span>, order <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></pre></div>
<p><img src="birthweight_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div id="parallel-processing" class="section level1">
<h1 class="hasAnchor">
<a href="#parallel-processing" class="anchor"></a>Parallel processing</h1>
<p>For large number of bootstrap runs, one might consider using parallel processing to reduce the total computational time. The parallel backend support of <code>APES</code> uses the <code>furrr</code> package. To invoke parallel processing, this requires a single parameter <code>workers</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="va">parallel_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/apes.html">apes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">full_model</span>, n_boot <span class="op">=</span> <span class="fl">100</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">parallel_result</span></pre></div>
</div>
<div id="reference" class="section level1">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<ul>
<li><p>Mueller, S. and Welsh, A. H. (2010), On model selection curves. International Statistical Review, 78:240-256. doi: 10.1111/j.1751-5823.2010.00108.x</p></li>
<li><p>Murray, K., Heritier, S. and Mueller, S. (2013), Graphical tools for model selection in generalized linear models. Statistics in Medicine, 32:4438-4451. doi: 10.1002/sim.5855</p></li>
<li><p>Tarr G, Mueller S and Welsh AH (2018). mplot: An R Package for Graphical Model Stability and Variable Selection Procedures. Journal of Statistical Software, 83(9), pp. 1-28. doi: 10.18637/jss.v083.i09</p></li>
<li><p>Wang, K. Y., Tarr, G., Yang, J. Y., &amp; Mueller, S. (2019). Fast and approximate exhaustive variable selection for generalised linear models with APES. Australian &amp; New Zealand Journal of Statistics, 61(4), 445–465. <a href="https://doi.org/10.1111/anzs.12276" class="uri">https://doi.org/10.1111/anzs.12276</a></p></li>
</ul>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<pre><code>## R version 4.0.3 (2020-10-10)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.0   stringr_1.4.0   dplyr_1.0.2     purrr_0.3.4    
##  [5] readr_1.4.0     tidyr_1.1.2     tibble_3.0.4    ggplot2_3.3.2  
##  [9] tidyverse_1.3.0 MASS_7.3-53     APES_0.6.0     
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.4.2         jsonlite_1.7.1     splines_4.0.3      modelr_0.1.8      
##  [5] gtools_3.8.2       assertthat_0.2.1   blob_1.2.1         cellranger_1.1.0  
##  [9] yaml_2.2.1         ggrepel_0.8.2      globals_0.13.1     pillar_1.4.6      
## [13] backports_1.1.10   lattice_0.20-41    glue_1.4.2         digest_0.6.26     
## [17] RColorBrewer_1.1-2 rvest_0.3.6        colorspace_1.4-1   plyr_1.8.6        
## [21] htmltools_0.5.0    Matrix_1.2-18      pkgconfig_2.0.3    broom_0.7.2       
## [25] listenv_0.8.0      haven_2.3.1        scales_1.1.1       farver_2.0.3      
## [29] generics_0.0.2     ellipsis_0.3.1     withr_2.3.0        furrr_0.2.1       
## [33] cli_2.1.0          survival_3.2-7     magrittr_1.5       crayon_1.3.4      
## [37] readxl_1.3.1       memoise_1.1.0      evaluate_0.14      ps_1.4.0          
## [41] fs_1.5.0           future_1.19.1      fansi_0.4.1        xml2_1.3.2        
## [45] textshaping_0.1.2  tools_4.0.3        hms_0.5.3          lifecycle_0.2.0   
## [49] munsell_0.5.0      reprex_0.3.0       compiler_4.0.3     pkgdown_1.6.1.9000
## [53] systemfonts_0.3.2  rlang_0.4.8        grid_4.0.3         rstudioapi_0.11   
## [57] leaps_3.1          labeling_0.4.2     rmarkdown_2.5      gtable_0.3.0      
## [61] codetools_0.2-16   DBI_1.1.0          reshape2_1.4.4     R6_2.4.1          
## [65] lubridate_1.7.9    knitr_1.30         utf8_1.1.4         rprojroot_1.3-2   
## [69] ragg_0.4.0         desc_1.2.0         stringi_1.5.3      parallel_4.0.3    
## [73] Rcpp_1.0.5         vctrs_0.3.4        dbplyr_1.4.4       tidyselect_1.1.0  
## [77] xfun_0.18</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Wang, Garth Tarr, Jean Yang, Samuel Mueller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
